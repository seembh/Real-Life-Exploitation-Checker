Program:
'begin'
    FinalAction
'end'
;

FinalAction:
    RunFile | SaveFile
;
RunFile:
    'run' filename=STRING
;

SaveFile:
    'define steps' number=INT steps*=Step?
    'define commands' commands*=Command?
    'save' filename=STRING
;

Step:
    id=INT ',' command=Command ';'
;

Command:
  EXECUTE_ORDER|
  READ_REGISTRY|
  READ_FILE|
  CHECK_VERSION|
  CUSTOM_COMMAND|
  SERVICE_STATUS|
  CHECK_HOTFIX_INSTALLED|
  GET_WINDOWS_VERSION
;

EXECUTE_ORDER:
  'execute' target=STRING
;

READ_REGISTRY:
  'read_registry' target=STRING "," expect=STRING
;

READ_FILE:
  'read_file' target=STRING "," expect=STRING
;

CHECK_VERSION:
  'check_version' target=STRING "," expect=STRING
;

CUSTOM_COMMAND:
    'custom' target=STRING "," expect=STRING
;

SERVICE_STATUS:
    'service_status' target=STRING "," expect=STRING
;

CHECK_HOTFIX_INSTALLED:
    'check_hotfix_installed' target=STRING "," expect=STRING
;

GET_WINDOWS_VERSION:
    'get_windows_version' expect=STRING
;