Set-ExecutionPolicy RemoteSigned
$step_1 = $null;
$step_1 = Get-Package -Name "Office 16 Click-to-Run Extensibility Component"| Select-Object Version | ForEach-Object {$_.Version}
If ($step_1 -ne $null)
{
$step_1 | Add-Content ".\Output\output.txt"
}
Else
{
echo null | Add-Content ".\Output\output.txt"
}

$step_2 = $null;
$step_2 = Get-Package -Name "Office 16 Click-to-Run Extensibility Component"| Select-Object Version | ForEach-Object {$_.Version}
If ($step_2 -ne $null)
{
$step_2 | Add-Content ".\Output\output.txt"
}
Else
{
echo null | Add-Content ".\Output\output.txt"
}

$step_3 = $null;
$step_3 = Get-Item -Path "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint" | Select-Object name
If ($step_3 -ne $null)
{
echo True | Add-Content ".\Output\output.txt"
}
Else
{
echo False | Add-Content ".\Output\output.txt"
}

$step_4 = $null;
$step_4 = Get-Item -Path "Registry::HKLM\SOFTWARE\Policies\Microsoft\Windows\network connectionss" | Select-Object name
If ($step_4 -ne $null)
{
echo True | Add-Content ".\Output\output.txt"
}
Else
{
echo False | Add-Content ".\Output\output.txt"
}

$step_5 = $null;
$step_5 = Get-Service -Name Spooler | Select-Object Status | ForEach-Object {$_.Status}
If ($step_5 -ne $null)
{
Get-Service -Name Spooler | Select-Object Status | ForEach-Object {$_.Status} | Add-Content ".\Output\output.txt"
}
Else
{
echo False | Add-Content ".\Output\output.txt"
}

$step_6 = $null;
$step_6 = (((Get-HotFix).HotFixID) -contains "KB5013887")
If ($step_6 -ne $null)
{
(((Get-HotFix).HotFixID) -contains "KB5013887") | Add-Content ".\Output\output.txt"
}
Else
{
echo False | Add-Content ".\Output\output.txt"
}

Exit
Set-ExecutionPolicy Restricted
