begin
    define steps 6
    1, check_version "Office 16 Click-to-Run Extensibility Component", "17";
    2, check_version "Office 16 Click-to-Run Extensibility Component", "16.0.15225.21";
    3, read_registry "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint", "False";
    4, read_registry "HKLM\SOFTWARE\Policies\Microsoft\Windows\network connectionss", "True";
    5, service_status "Spooler", "Running";
    6, check_hotfix_installed "KB5013887", "True";
    define commands
    execute "({s1} and {s2}) or ({s3} and {s4} and {s5} or {s6})"

    save "CVE-2022-30191"
end