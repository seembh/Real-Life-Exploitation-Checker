def return_command(command, target="%%%Target placeholder%%%"):
    # Tuple containing "MACRO" of command and the powershell command, including the target
    commands = [("CHECK_VERSION",
                 "Get-Package -Name " + "\"" + target + "\"" +
                 "| Select-Object Version " + "| ForEach-Object {$_.Version}"),

                ("READ_REGISTRY",
                 "Get-Item -Path \"Registry::" + target + "\"" + " | Select-Object name"),

                ("CUSTOM_COMMAND",
                 target),

                ("SERVICE_STATUS",
                 "Get-Service -Name " + target + " | Select-Object Status | ForEach-Object {$_.Status}"),

                ("CHECK_HOTFIX_INSTALLED",
                 "(((Get-HotFix).HotFixID) -contains \"" + target + "\")")
                ]
    for item in commands:
        if command == item[0]:
            return item[1]
    return "echo \"Command not provided\""
